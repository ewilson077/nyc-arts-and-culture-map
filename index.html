<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>NYC Arts and Culture Guide</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
        }
        h3 {
            margin: 0;
            padding: 10px;
            text-align: center;
            background-color: #f4f4f4;
        }
        #map {
            height: 90vh;
            width: 100%;
        }
    </style>
</head>
<body>
    <h3><b>NYC Arts and Culture Guide</b></h3>
    <div id="map"></div>

    <!-- Leaflet core -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-ajax/dist/leaflet.ajax.min.js"></script>

    <!-- Wicket -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/wicket/1.3.4/wicket.min.js"></script>

    <!-- PapaParse -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>

    <script>
        // Create map
        var map = L.map('map').setView([40.75, -73.97], 11);

        // Base map
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '¬© OpenStreetMap contributors'
        }).addTo(map);

        // 1Ô∏è‚É£ Borough boundaries with your original styling
        var boroughsLayer = new L.GeoJSON.AJAX("./data/Borough Boundaries.geojson", {
            style: function (feature) {
                return {
                    color: "#2b8cbe",
                    weight: 2,
                    fillColor: "#a6bddb",
                    fillOpacity: 0.2
                };
            }
        }).addTo(map);

        // Function to load and plot CSV points
        function loadCsvPoints(url, iconEmoji, color) {
            fetch(url)
                .then(res => res.text())
                .then(text => {
                    Papa.parse(text, {
                        header: false,
                        skipEmptyLines: true,
                        complete: function(results) {
                            results.data.forEach(cols => {
                                if (cols.length < 5) return; // skip bad rows

                                const geom = cols[cols.length - 1];
                                const name = cols[0];
                                const address = cols[1];
                                const borough = cols[2];
                                const type = cols[3];
                                const urlReport = cols[4];

                                try {
                                    const wkt = new Wkt.Wkt();
                                    wkt.read(geom);
                                    const latLng = wkt.toObject().getBounds().getCenter();

                                    L.circleMarker([latLng.lat, latLng.lng], {
                                        radius: 6,
                                        color: color,
                                        fillColor: color,
                                        fillOpacity: 0.8
                                    })
                                    .addTo(map)
                                    .bindPopup(`${iconEmoji} <strong>${name}</strong><br>${address}<br>Borough: ${borough}<br>Type: ${type}<br><a href="${urlReport}" target="_blank">More Info</a>`);
                                } catch (err) {
                                    console.error("Invalid WKT for:", name, err);
                                }
                            });
                        }
                    });
                });
        }

        // 2Ô∏è‚É£ Landmarks (red)
        loadCsvPoints("./data/landmarks.csv", "üèõ", "red");

        // 3Ô∏è‚É£ Museums (green)
        loadCsvPoints("./data/museums.csv", "üñº", "green");

        // 4Ô∏è‚É£ Galleries (purple)
        loadCsvPoints("./data/galleries.csv", "üé®", "purple");

    </script>
</body>
</html>


 
